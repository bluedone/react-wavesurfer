!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports["react-wavesurfer"]=t(require("react")):(e.ReactWavesurfer=e.ReactWavesurfer||{},e.ReactWavesurfer["react-wavesurfer"]=t(e.React))}(this,function(e){return function(e){function t(r){if(i[r])return i[r].exports;var s=i[r]={exports:{},id:r,loaded:!1};return e[r].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){return e.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join("")}function h(e,t,i){var r=e[t];return void 0!==r&&("number"!=typeof r||r!==parseInt(r,10)||0>r)?new Error("Invalid `"+t+"` supplied to `"+i+"`, expected a positive integer"):void 0}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),l=i(3),d=r(l),p=i(1),f=r(p),m=i(2),v=["audioprocess","error","finish","loading","mouseup","pause","play","ready","scroll","seek","zoom"],y=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,e));if(i.state={pos:0},void 0===("undefined"==typeof m?"undefined":u(m)))throw new Error("WaveSurfer is undefined!");return i._wavesurfer=Object.create(m),i._isReady=!1,i._playing=!1,i._loadAudio=i._loadAudio.bind(i),i._seekTo=i._seekTo.bind(i),i}return a(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this,t=(0,f["default"])({},this.props.options,{container:this.refs.wavesurfer});this._wavesurfer.init(t),this._wavesurfer.on("ready",function(){e._isReady=!0,e.props.pos&&e._seekTo(e.props.pos),e.props.volume&&e._wavesurfer.setVolume(e.props.volume),e.props.zoom&&e._wavesurfer.zoom(e.props.zoom)}),this._wavesurfer.on("audioprocess",function(t){e.setState({pos:t}),e.props.onPosChange({wavesurfer:e._wavesurfer,originalArgs:[t]})}),this._wavesurfer.on("seek",function(t){t=e._posToSec(t),e.setState({pos:t}),e.props.onPosChange({wavesurfer:e._wavesurfer,originalArgs:[t]})}),v.forEach(function(t){var i=e.props["on"+o(t)],r=e._wavesurfer;i&&e._wavesurfer.on(t,function(){i({wavesurfer:r,originalArgs:[].concat(Array.prototype.slice.call(arguments))})})}),this.props.audioFile&&this._loadAudio(this.props.audioFile)}},{key:"componentWillUnmount",value:function(){var e=this;v.forEach(function(t){e._wavesurfer.un(t)}),this._wavesurfer.destroy()}},{key:"componentWillReceiveProps",value:function(e){this.props.audioFile!==e.audioFile&&this._loadAudio(e.audioFile),e.pos&&this._isReady&&e.pos!==this.props.pos&&e.pos!==this.state.pos&&this._seekTo(e.pos),this.props.playing===e.playing&&this._wavesurfer.isPlaying()===e.playing||(e.playing?(this._wavesurfer.play(),this._playing=!0):(this._wavesurfer.pause(),this._playing=!1)),this.props.volume!==e.volume&&this._wavesurfer.setVolume(e.volume),this.props.zoom!==e.zoom&&this._wavesurfer.zoom(e.zoom)}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"_secToPos",value:function(e){return 1/this._wavesurfer.getDuration()*e}},{key:"_posToSec",value:function(e){return e*this._wavesurfer.getDuration()}},{key:"_seekTo",value:function(e){var t=this._secToPos(e);this.props.autoCenter?this._wavesurfer.seekAndCenter(t):this._wavesurfer.seekTo(t)}},{key:"_loadAudio",value:function(e){if("string"==typeof e)this._wavesurfer.load(e);else{if(!(e instanceof Blob||e instanceof File))throw new Error("Wavesurfer._loadAudio expexts prop audioFile to be either string or file/blob");this._wavesurfer.loadBlob(e)}}},{key:"render",value:function(){var e=this,t=this.props.children?d["default"].Children.map(this.props.children,function(t){return d["default"].cloneElement(t,(0,f["default"])({},{wavesurfer:e._wavesurfer,isReady:e._isReady},e.props))}):!1;return d["default"].createElement("div",null,d["default"].createElement("div",{ref:"wavesurfer"}),t)}}]),t}(l.Component);y.propTypes={playing:l.PropTypes.bool,pos:l.PropTypes.number,audioFile:function(e,t,i){var r=e[t];return r&&"string"!=typeof r&&!r instanceof Blob&&!r instanceof File?new Error("Invalid `"+t+"` supplied to `"+i+"` expected either string or file/blob"):void 0},regions:l.PropTypes.array,volume:l.PropTypes.number,zoom:l.PropTypes.number,options:l.PropTypes.shape({audioRate:l.PropTypes.number,backend:l.PropTypes.oneOf(["WebAudio","MediaElement"]),barWidth:function(e,t,i){var r=e[t];return void 0!==r&&"number"!=typeof r?new Error("Invalid `"+t+"` supplied to `"+i+"` expected either undefined or number"):void 0},cursorColor:l.PropTypes.string,cursorWidth:h,dragSelection:l.PropTypes.bool,fillParent:l.PropTypes.bool,height:h,hideScrollbar:l.PropTypes.bool,interact:l.PropTypes.bool,loopSelection:l.PropTypes.bool,mediaControls:l.PropTypes.bool,minPxPerSec:h,normalize:l.PropTypes.bool,pixelRatio:l.PropTypes.number,progressColor:l.PropTypes.string,scrollParent:l.PropTypes.bool,skipLength:l.PropTypes.number,waveColor:l.PropTypes.string,autoCenter:l.PropTypes.bool})},y.defaultProps={playing:!1,pos:0,audioFile:void 0,options:m.defaultParams,onPosChange:function(){}},t["default"]=y},function(e,t){"use strict";function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var n,a,o=i(e),h=1;h<arguments.length;h++){n=Object(arguments[h]);for(var u in n)r.call(n,u)&&(o[u]=n[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(n);for(var c=0;c<a.length;c++)s.call(n,a[c])&&(o[a[c]]=n[a[c]])}}return o}},function(e,t,i){var r,s;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};/*! wavesurfer.js 1.0.58 (Sun, 28 Feb 2016 19:39:50 GMT)
	* https://github.com/katspaugh/wavesurfer.js
	* @license CC-BY-3.0 */
!function(i,n){r=[],s=function(){return i.WaveSurfer=n()}.apply(t,r),!(void 0!==s&&(e.exports=s))}(void 0,function(){"use strict";var e={defaultParams:{height:128,waveColor:"#999",progressColor:"#555",cursorColor:"#333",cursorWidth:1,skipLength:2,minPxPerSec:20,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,fillParent:!0,scrollParent:!1,hideScrollbar:!1,normalize:!1,audioContext:null,container:null,dragSelection:!0,loopSelection:!0,audioRate:1,interact:!0,splitChannels:!1,mediaContainer:null,mediaControls:!1,renderer:"Canvas",backend:"WebAudio",mediaType:"audio",autoCenter:!0},init:function(t){if(this.params=e.util.extend({},this.defaultParams,t),this.container="string"==typeof t.container?document.querySelector(this.params.container):this.params.container,!this.container)throw new Error("Container element not found");if(null==this.params.mediaContainer?this.mediaContainer=this.container:"string"==typeof this.params.mediaContainer?this.mediaContainer=document.querySelector(this.params.mediaContainer):this.mediaContainer=this.params.mediaContainer,!this.mediaContainer)throw new Error("Media Container element not found");this.savedVolume=0,this.isMuted=!1,this.tmpEvents=[],this.createDrawer(),this.createBackend()},createDrawer:function(){var t=this;this.drawer=Object.create(e.Drawer[this.params.renderer]),this.drawer.init(this.container,this.params),this.drawer.on("redraw",function(){t.drawBuffer(),t.drawer.progress(t.backend.getPlayedPercents())}),this.drawer.on("click",function(e,i){setTimeout(function(){t.seekTo(i)},0)}),this.drawer.on("scroll",function(e){t.fireEvent("scroll",e)})},createBackend:function(){var t=this;this.backend&&this.backend.destroy(),"AudioElement"==this.params.backend&&(this.params.backend="MediaElement"),"WebAudio"!=this.params.backend||e.WebAudio.supportsWebAudio()||(this.params.backend="MediaElement"),this.backend=Object.create(e[this.params.backend]),this.backend.init(this.params),this.backend.on("finish",function(){t.fireEvent("finish")}),this.backend.on("play",function(){t.fireEvent("play")}),this.backend.on("pause",function(){t.fireEvent("pause")}),this.backend.on("audioprocess",function(e){t.fireEvent("audioprocess",e)})},startAnimationLoop:function(){var e=this,t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,i=function r(){if(!e.backend.isPaused()){var i=e.backend.getPlayedPercents();e.drawer.progress(i),e.fireEvent("audioprocess",e.getCurrentTime()),t(r)}};i()},getDuration:function(){return this.backend.getDuration()},getCurrentTime:function(){return this.backend.getCurrentTime()},play:function(e,t){this.backend.play(e,t),this.startAnimationLoop()},pause:function(){this.backend.pause()},playPause:function(){this.backend.isPaused()?this.play():this.pause()},isPlaying:function(){return!this.backend.isPaused()},skipBackward:function(e){this.skip(-e||-this.params.skipLength)},skipForward:function(e){this.skip(e||this.params.skipLength)},skip:function(e){var t=this.getCurrentTime()||0,i=this.getDuration()||1;t=Math.max(0,Math.min(i,t+(e||0))),this.seekAndCenter(t/i)},seekAndCenter:function(e){this.seekTo(e),this.drawer.recenter(e)},seekTo:function(e){var t=this.backend.isPaused(),i=this.params.scrollParent;t&&(this.params.scrollParent=!1),this.backend.seekTo(e*this.getDuration()),this.drawer.progress(this.backend.getPlayedPercents()),t||(this.backend.pause(),this.backend.play()),this.params.scrollParent=i,this.fireEvent("seek",e)},stop:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)},setVolume:function(e){this.backend.setVolume(e)},setPlaybackRate:function(e){this.backend.setPlaybackRate(e)},toggleMute:function(){this.isMuted?(this.backend.setVolume(this.savedVolume),this.isMuted=!1):(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0)},toggleScroll:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()},toggleInteraction:function(){this.params.interact=!this.params.interact},drawBuffer:function(){var e=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),t=this.drawer.getWidth(),i=e;this.params.fillParent&&(!this.params.scrollParent||t>e)&&(i=t);var r=this.backend.getPeaks(i);this.drawer.drawPeaks(r,i),this.fireEvent("redraw",r,i)},zoom:function(e){this.params.minPxPerSec=e,this.params.scrollParent=!0,this.drawBuffer(),this.seekAndCenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)},loadArrayBuffer:function(e){this.decodeArrayBuffer(e,function(e){this.loadDecodedBuffer(e)}.bind(this))},loadDecodedBuffer:function(e){this.backend.load(e),this.drawBuffer(),this.fireEvent("ready")},loadBlob:function(e){var t=this,i=new FileReader;i.addEventListener("progress",function(e){t.onProgress(e)}),i.addEventListener("load",function(e){t.loadArrayBuffer(e.target.result)}),i.addEventListener("error",function(){t.fireEvent("error","Error reading file")}),i.readAsArrayBuffer(e),this.empty()},load:function(e,t){switch(this.params.backend){case"WebAudio":return this.loadBuffer(e);case"MediaElement":return this.loadMediaElement(e,t)}},loadBuffer:function(e){return this.empty(),this.getArrayBuffer(e,this.loadArrayBuffer.bind(this))},loadMediaElement:function(e,t){this.empty(),this.backend.load(e,this.mediaContainer,t),this.tmpEvents.push(this.backend.once("canplay",function(){this.drawBuffer(),this.fireEvent("ready")}.bind(this)),this.backend.once("error",function(e){this.fireEvent("error",e)}.bind(this))),!t&&this.backend.supportsWebAudio()&&this.getArrayBuffer(e,function(e){this.decodeArrayBuffer(e,function(e){this.backend.buffer=e,this.drawBuffer()}.bind(this))}.bind(this))},decodeArrayBuffer:function(e,t){this.backend.decodeArrayBuffer(e,this.fireEvent.bind(this,"decoded"),this.fireEvent.bind(this,"error","Error decoding audiobuffer")),this.tmpEvents.push(this.once("decoded",t))},getArrayBuffer:function(t,i){var r=this,s=e.util.ajax({url:t,responseType:"arraybuffer"});return this.tmpEvents.push(s.on("progress",function(e){r.onProgress(e)}),s.on("success",i),s.on("error",function(e){r.fireEvent("error","XHR error: "+e.target.statusText)})),s},onProgress:function(e){if(e.lengthComputable)var t=e.loaded/e.total;else t=e.loaded/(e.loaded+1e6);this.fireEvent("loading",Math.round(100*t),e.target)},exportPCM:function(e,t,i){e=e||1024,t=t||1e4,i=i||!1;var r=this.backend.getPeaks(e,t),s=[].map.call(r,function(e){return Math.round(e*t)/t}),n=JSON.stringify(s);return i||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(n)),n},clearTmpEvents:function(){this.tmpEvents.forEach(function(e){e.un()})},empty:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)},destroy:function(){this.fireEvent("destroy"),this.clearTmpEvents(),this.unAll(),this.backend.destroy(),this.drawer.destroy()}};return e.create=function(t){var i=Object.create(e);return i.init(t),i},e.util={extend:function(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){Object.keys(t).forEach(function(i){e[i]=t[i]})}),e},getId:function(){return"wavesurfer_"+Math.random().toString(32).substring(2)},ajax:function(t){var i=Object.create(e.Observer),r=new XMLHttpRequest,s=!1;return r.open(t.method||"GET",t.url,!0),r.responseType=t.responseType||"json",r.addEventListener("progress",function(e){i.fireEvent("progress",e),e.lengthComputable&&e.loaded==e.total&&(s=!0)}),r.addEventListener("load",function(e){s||i.fireEvent("progress",e),i.fireEvent("load",e),200==r.status||206==r.status?i.fireEvent("success",r.response,e):i.fireEvent("error",e)}),r.addEventListener("error",function(e){i.fireEvent("error",e)}),r.send(),i.xhr=r,i}},e.Observer={on:function(e,t){this.handlers||(this.handlers={});var i=this.handlers[e];return i||(i=this.handlers[e]=[]),i.push(t),{name:e,callback:t,un:this.un.bind(this,e,t)}},un:function(e,t){if(this.handlers){var i=this.handlers[e];if(i)if(t)for(var r=i.length-1;r>=0;r--)i[r]==t&&i.splice(r,1);else i.length=0}},unAll:function(){this.handlers=null},once:function(e,t){var i=this,r=function s(){t.apply(this,arguments),setTimeout(function(){i.un(e,s)},0)};return this.on(e,r)},fireEvent:function(e){if(this.handlers){var t=this.handlers[e],i=Array.prototype.slice.call(arguments,1);t&&t.forEach(function(e){e.apply(null,i)})}}},e.util.extend(e,e.Observer),e.WebAudio={scriptBufferSize:256,PLAYING_STATE:0,PAUSED_STATE:1,FINISHED_STATE:2,supportsWebAudio:function(){return!(!window.AudioContext&&!window.webkitAudioContext)},getAudioContext:function(){return e.WebAudio.audioContext||(e.WebAudio.audioContext=new(window.AudioContext||window.webkitAudioContext)),e.WebAudio.audioContext},getOfflineAudioContext:function(t){return e.WebAudio.offlineAudioContext||(e.WebAudio.offlineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,t)),e.WebAudio.offlineAudioContext},init:function(t){this.params=t,this.ac=t.audioContext||this.getAudioContext(),this.lastPlay=this.ac.currentTime,this.startPosition=0,this.scheduledPause=null,this.states=[Object.create(e.WebAudio.state.playing),Object.create(e.WebAudio.state.paused),Object.create(e.WebAudio.state.finished)],this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(this.PAUSED_STATE),this.setPlaybackRate(this.params.audioRate)},disconnectFilters:function(){this.filters&&(this.filters.forEach(function(e){e&&e.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))},setState:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))},setFilter:function(){this.setFilters([].slice.call(arguments))},setFilters:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce(function(e,t){return e.connect(t),t},this.analyser).connect(this.gainNode))},createScriptNode:function(){this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(this.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(this.scriptBufferSize),this.scriptNode.connect(this.ac.destination)},addOnAudioProcess:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime();t>=e.getDuration()?(e.setState(e.FINISHED_STATE),e.fireEvent("pause")):t>=e.scheduledPause?(e.setState(e.PAUSED_STATE),e.fireEvent("pause")):e.state===e.states[e.PLAYING_STATE]&&e.fireEvent("audioprocess",t)}},removeOnAudioProcess:function(){this.scriptNode.onaudioprocess=null},createAnalyserNode:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)},createVolumeNode:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)},setVolume:function(e){this.gainNode.gain.value=e},getVolume:function(){return this.gainNode.gain.value},decodeArrayBuffer:function(e,t,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(e,function(e){t(e)}.bind(this),i)},getPeaks:function(e){for(var t=this.buffer.length/e,i=~~(t/10)||1,r=this.buffer.numberOfChannels,s=[],n=[],a=0;r>a;a++)for(var o=s[a]=[],h=this.buffer.getChannelData(a),u=0;e>u;u++){for(var c=~~(u*t),l=~~(c+t),d=h[0],p=h[0],f=c;l>f;f+=i){var m=h[f];m>p&&(p=m),d>m&&(d=m)}o[2*u]=p,o[2*u+1]=d,(0==a||p>n[2*u])&&(n[2*u]=p),(0==a||d<n[2*u+1])&&(n[2*u+1]=d)}return this.params.splitChannels?s:n},getPlayedPercents:function(){return this.state.getPlayedPercents.call(this)},disconnectSource:function(){this.source&&this.source.disconnect()},destroy:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect()},load:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()},createSource:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)},isPaused:function(){return this.state!==this.states[this.PLAYING_STATE]},getDuration:function(){return this.buffer?this.buffer.duration:0},seekTo:function(e,t){return this.scheduledPause=null,null==e&&(e=this.getCurrentTime(),e>=this.getDuration()&&(e=0)),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states[this.FINISHED_STATE]&&this.setState(this.PAUSED_STATE),{start:e,end:t}},getPlayedTime:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate},play:function(e,t){this.createSource();var i=this.seekTo(e,t);e=i.start,t=i.end,this.scheduledPause=t,this.source.start(0,e,t-e),this.setState(this.PLAYING_STATE),this.fireEvent("play")},pause:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(this.PAUSED_STATE),this.fireEvent("pause")},getCurrentTime:function(){return this.state.getCurrentTime.call(this)},setPlaybackRate:function(e){e=e||1,this.isPaused()?this.playbackRate=e:(this.pause(),this.playbackRate=e,this.play())}},e.WebAudio.state={},e.WebAudio.state.playing={init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}},e.WebAudio.state.paused={init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}},e.WebAudio.state.finished={init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}},e.util.extend(e.WebAudio,e.Observer),e.MediaElement=Object.create(e.WebAudio),e.util.extend(e.MediaElement,{init:function(e){this.params=e,this.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},this.mediaType=e.mediaType.toLowerCase(),this.elementPosition=e.elementPosition,this.setPlaybackRate(this.params.audioRate)},load:function(e,t,i){var r=this,s=document.createElement(this.mediaType);s.controls=this.params.mediaControls,s.autoplay=this.params.autoplay||!1,s.preload="auto",s.src=e,s.style.width="100%",s.addEventListener("error",function(){r.fireEvent("error","Error loading media element")}),s.addEventListener("canplay",function(){r.fireEvent("canplay")}),s.addEventListener("ended",function(){r.fireEvent("finish")}),s.addEventListener("timeupdate",function(){r.fireEvent("audioprocess",r.getCurrentTime())});var n=t.querySelector(this.mediaType);n&&t.removeChild(n),t.appendChild(s),this.media=s,this.peaks=i,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)},isPaused:function(){return!this.media||this.media.paused},getDuration:function(){var e=this.media.duration;return e>=1/0&&(e=this.media.seekable.end()),e},getCurrentTime:function(){return this.media&&this.media.currentTime},getPlayedPercents:function(){return this.getCurrentTime()/this.getDuration()||0},setPlaybackRate:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate},seekTo:function(e){null!=e&&(this.media.currentTime=e),this.clearPlayEnd()},play:function(e,t){this.seekTo(e),this.media.play(),t&&this.setPlayEnd(t),this.fireEvent("play")},pause:function(){this.media&&this.media.pause(),this.clearPlayEnd(),this.fireEvent("pause")},setPlayEnd:function(e){var t=this;this.onPlayEnd=function(i){i>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this.onPlayEnd)},clearPlayEnd:function(){this.onPlayEnd&&(this.un("audioprocess",this.onPlayEnd),this.onPlayEnd=null)},getPeaks:function(t){return this.buffer?e.WebAudio.getPeaks.call(this,t):this.peaks||[]},getVolume:function(){return this.media.volume},setVolume:function(e){this.media.volume=e},destroy:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}),e.AudioElement=e.MediaElement,e.Drawer={init:function(e,t){this.container=e,this.params=t,this.width=0,this.height=t.height*this.params.pixelRatio,this.lastPos=0,this.createWrapper(),this.createElements()},createWrapper:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()},handleEvent:function(e){e.preventDefault();var t=this.wrapper.getBoundingClientRect();return(e.clientX-t.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0},setupWrapperEvents:function(){var e=this;this.wrapper.addEventListener("click",function(t){var i=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!=i){var r=e.wrapper.getBoundingClientRect();if(t.clientY>=r.bottom-i)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))}),this.wrapper.addEventListener("scroll",function(t){e.fireEvent("scroll",t)})},drawPeaks:function(e,t){this.resetScroll(),this.setWidth(t),this.params.barWidth?this.drawBars(e):this.drawWave(e)},style:function(e,t){return Object.keys(t).forEach(function(i){e.style[i]!==t[i]&&(e.style[i]=t[i])}),e},resetScroll:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)},recenter:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)},recenterOnPosition:function(e,t){var i=this.wrapper.scrollLeft,r=~~(this.wrapper.clientWidth/2),s=e-r,n=s-i,a=this.wrapper.scrollWidth-this.wrapper.clientWidth;if(0!=a){if(!t&&n>=-r&&r>n){var o=5;n=Math.max(-o,Math.min(o,n)),s=i+n}s=Math.max(0,Math.min(a,s)),s!=i&&(this.wrapper.scrollLeft=s)}},getWidth:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)},setWidth:function(e){e!=this.width&&(this.width=e,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize())},setHeight:function(e){e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize())},progress:function(e){var t=1/this.params.pixelRatio,i=Math.round(e*this.width)*t;if(i<this.lastPos||i-this.lastPos>=t){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var r=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(r)}this.updateProgress(e)}},destroy:function(){this.unAll(),this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=null)},createElements:function(){},updateSize:function(){},drawWave:function(e,t){},clearWave:function(){},updateProgress:function(e){}},e.util.extend(e.Drawer,e.Observer),e.Drawer.Canvas=Object.create(e.Drawer),e.util.extend(e.Drawer.Canvas,{createElements:function(){var e=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:0,top:0,bottom:0}));if(this.waveCc=e.getContext("2d"),this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})),this.params.waveColor!=this.params.progressColor){var t=this.progressWave.appendChild(document.createElement("canvas"));this.progressCc=t.getContext("2d")}},updateSize:function(){var e=Math.round(this.width/this.params.pixelRatio);this.waveCc.canvas.width=this.width,this.waveCc.canvas.height=this.height,this.style(this.waveCc.canvas,{width:e+"px"}),this.style(this.progressWave,{display:"block"}),this.progressCc&&(this.progressCc.canvas.width=this.width,this.progressCc.canvas.height=this.height,this.style(this.progressCc.canvas,{width:e+"px"})),this.clearWave()},clearWave:function(){this.waveCc.clearRect(0,0,this.width,this.height),this.progressCc&&this.progressCc.clearRect(0,0,this.width,this.height)},drawBars:function(e,t){if(e[0]instanceof Array){var i=e;if(this.params.splitChannels)return this.setHeight(i.length*this.params.height*this.params.pixelRatio),void i.forEach(this.drawBars,this);e=i[0]}var r=[].some.call(e,function(e){return 0>e});r&&(e=[].filter.call(e,function(e,t){return t%2==0}));var s=.5/this.params.pixelRatio,n=this.width,a=this.params.height*this.params.pixelRatio,o=a*t||0,h=a/2,u=e.length,c=this.params.barWidth*this.params.pixelRatio,l=Math.max(this.params.pixelRatio,~~(c/2)),d=c+l,p=1;this.params.normalize&&(p=Math.max.apply(Math,e));var f=u/n;this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(t){if(t)for(var i=0;n>i;i+=d){var r=Math.round(e[Math.floor(i*f)]/p*h);t.fillRect(i+s,h-r+o,c+s,2*r)}},this)},drawWave:function(e,t){if(e[0]instanceof Array){var i=e;if(this.params.splitChannels)return this.setHeight(i.length*this.params.height*this.params.pixelRatio),void i.forEach(this.drawWave,this);e=i[0]}var r=[].some.call(e,function(e){return 0>e});if(!r){for(var s=[],n=0,a=e.length;a>n;n++)s[2*n]=e[n],s[2*n+1]=-e[n];e=s}var o=.5/this.params.pixelRatio,h=this.params.height*this.params.pixelRatio,u=h*t||0,c=h/2,l=~~(e.length/2),d=1;this.params.fillParent&&this.width!=l&&(d=this.width/l);var p=1;if(this.params.normalize){var f=Math.max.apply(Math,e),m=Math.min.apply(Math,e);p=-m>f?-m:f}this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(t){if(t){t.beginPath(),t.moveTo(o,c+u);for(var i=0;l>i;i++){var r=Math.round(e[2*i]/p*c);t.lineTo(i*d+o,c-r+u)}for(var i=l-1;i>=0;i--){var r=Math.round(e[2*i+1]/p*c);t.lineTo(i*d+o,c-r+u)}t.closePath(),t.fill(),t.fillRect(0,c+u-o,this.width,o)}},this)},updateProgress:function(e){var t=Math.round(this.width*e)/this.params.pixelRatio;this.style(this.progressWave,{width:t+"px"})}}),function(){var t=function i(){var i=document.querySelectorAll("wavesurfer");Array.prototype.forEach.call(i,function(t){var i=e.util.extend({container:t,backend:"MediaElement",mediaControls:!0},t.dataset);t.style.display="block";var r=e.create(i);if(t.dataset.peaks)var s=JSON.parse(t.dataset.peaks);r.load(t.dataset.url,s)})};"complete"===document.readyState?t():window.addEventListener("load",t)}(),e})},function(t,i){t.exports=e}])});