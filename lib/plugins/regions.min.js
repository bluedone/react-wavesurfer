!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("wavesurfer.js"),require("react")):"function"==typeof define&&define.amd?define(["wavesurfer","react"],t):"object"==typeof exports?exports["plugins/regions"]=t(require("wavesurfer.js"),require("react")):(e.Wavesurfer=e.Wavesurfer||{},e.Wavesurfer["plugins/regions"]=t(e.WaveSurfer,e.React))}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join("")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),h=r(2),d=n(h),l=(r(3),["region-in ","region-out","region-mouseenter","region-mouseleave","region-click","region-dblclick","region-created ","region-updated ","region-update-end ","region-removed "]),f=function(e){function t(e){return i(this,t),s(this,Object.getPrototypeOf(t).call(this,e))}return o(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this;this.props._isReady&&this.init(),this.props.wavesurfer.on("ready",this._init.bind(this)),l.forEach(function(t){var r=e.props["on"+a(t)],n=e.props.wavesurfer;r&&e.props.wavesurfer.on(t,function(){r({wavesurfer:n,originalArgs:[].concat(Array.prototype.slice.call(arguments))})})})}},{key:"_init",value:function(){var e=this;this.props.regions.map(function(t){return e.props.wavesurfer.addRegion(t)})}},{key:"render",value:function(){return d["default"].createElement("div",null)}}]),t}(h.Component);f.propTypes={isReady:h.PropTypes.bool,regions:h.PropTypes.array},f.defaultProps={regions:[]},t["default"]=f},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){var n,i;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(s,o){n=[r(1)],i=function(e){return o(e)}.apply(t,n),!(void 0!==i&&(e.exports=i))}(void 0,function(e){"use strict";e.Regions={init:function(e){this.wavesurfer=e,this.wrapper=this.wavesurfer.drawer.wrapper,this.list={}},add:function(t){var r=Object.create(e.Region);return r.init(t,this.wavesurfer),this.list[r.id]=r,r.on("remove",function(){delete this.list[r.id]}.bind(this)),r},clear:function(){Object.keys(this.list).forEach(function(e){this.list[e].remove()},this)},enableDragSelection:function(e){function t(e){i=!0,"undefined"!=typeof e.targetTouches&&1===e.targetTouches.length&&(e.clientX=e.targetTouches[0].clientX),s=a.wavesurfer.drawer.handleEvent(e),o=null}function r(e){i=!1,o&&(o.fireEvent("update-end",e),a.wavesurfer.fireEvent("region-update-end",o,e)),o=null}function n(t){if(i){o||(o=a.add(e||{}));var r=a.wavesurfer.getDuration();"undefined"!=typeof t.targetTouches&&1===t.targetTouches.length&&(t.clientX=t.targetTouches[0].clientX);var n=a.wavesurfer.drawer.handleEvent(t);o.update({start:Math.min(n*r,s*r),end:Math.max(n*r,s*r)})}}var i,s,o,a=this;this.wrapper.addEventListener("mousedown",t),this.wrapper.addEventListener("touchstart",t),this.wrapper.addEventListener("mouseup",r),this.wrapper.addEventListener("touchend",r),this.wrapper.addEventListener("mousemove",n),this.wrapper.addEventListener("touchmove",n)}},e.Region={style:e.Drawer.style,init:function(t,r){this.wavesurfer=r,this.wrapper=r.drawer.wrapper,this.id=null==t.id?e.util.getId():t.id,this.start=Number(t.start)||0,this.end=null==t.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(t.end),this.resize=void 0===t.resize?!0:Boolean(t.resize),this.drag=void 0===t.drag?!0:Boolean(t.drag),this.loop=Boolean(t.loop),this.color=t.color||"rgba(0, 0, 0, 0.1)",this.data=t.data||{},this.attributes=t.attributes||{},this.maxLength=t.maxLength,this.minLength=t.minLength,this.bindInOut(),this.render(),this.wavesurfer.on("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-created",this)},update:function(e){null!=e.start&&(this.start=Number(e.start)),null!=e.end&&(this.end=Number(e.end)),null!=e.loop&&(this.loop=Boolean(e.loop)),null!=e.color&&(this.color=e.color),null!=e.data&&(this.data=e.data),null!=e.resize&&(this.resize=Boolean(e.resize)),null!=e.drag&&(this.drag=Boolean(e.drag)),null!=e.maxLength&&(this.maxLength=Number(e.maxLength)),null!=e.minLength&&(this.minLength=Number(e.minLength)),null!=e.attributes&&(this.attributes=e.attributes),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this)},remove:function(e){this.element&&(this.wrapper.removeChild(this.element),this.element=null,this.fireEvent("remove"),this.wavesurfer.un("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-removed",this))},play:function(){this.wavesurfer.play(this.start,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)},playLoop:function(){this.play(),this.once("out",this.playLoop.bind(this))},render:function(){var e=document.createElement("region");e.className="wavesurfer-region",e.title=this.formatTime(this.start,this.end),e.setAttribute("data-id",this.id);for(var t in this.attributes)e.setAttribute("data-region-"+t,this.attributes[t]);this.wrapper.scrollWidth;if(this.style(e,{position:"absolute",zIndex:2,height:"100%",top:"0px"}),this.resize){var r=e.appendChild(document.createElement("handle")),n=e.appendChild(document.createElement("handle"));r.className="wavesurfer-handle wavesurfer-handle-start",n.className="wavesurfer-handle wavesurfer-handle-end";var i={cursor:"col-resize",position:"absolute",left:"0px",top:"0px",width:"1%",maxWidth:"4px",height:"100%"};this.style(r,i),this.style(n,i),this.style(n,{left:"100%"})}this.element=this.wrapper.appendChild(e),this.updateRender(),this.bindEvents(e)},formatTime:function(e,t){return(e==t?[e]:[e,t]).map(function(e){return[Math.floor(e%3600/60),("00"+Math.floor(e%60)).slice(-2)].join(":")}).join("-")},updateRender:function(e){var t,r=this.wavesurfer.getDuration();if(t=e?Math.round(this.wavesurfer.getDuration()*e):this.wrapper.scrollWidth,this.start<0&&(this.start=0,this.end=this.end-this.start),this.end>r&&(this.end=r,this.start=r-(this.end-this.start)),null!=this.minLength&&(this.end=Math.max(this.start+this.minLength,this.end)),null!=this.maxLength&&(this.end=Math.min(this.start+this.maxLength,this.end)),null!=this.element){this.style(this.element,{left:~~(this.start/r*t)+"px",width:~~((this.end-this.start)/r*t)+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"});for(var n in this.attributes)this.element.setAttribute("data-region-"+n,this.attributes[n]);this.element.title=this.formatTime(this.start,this.end)}},bindInOut:function(){var e=this;e.firedIn=!1,e.firedOut=!1;var t=function(t){!e.firedIn&&e.start<=t&&e.end>t&&(e.firedIn=!0,e.firedOut=!1,e.fireEvent("in"),e.wavesurfer.fireEvent("region-in",e)),!e.firedOut&&e.firedIn&&(e.start>=Math.round(100*t)/100||e.end<=Math.round(100*t)/100)&&(e.firedOut=!0,e.firedIn=!1,e.fireEvent("out"),e.wavesurfer.fireEvent("region-out",e))};this.wavesurfer.backend.on("audioprocess",t),this.on("remove",function(){e.wavesurfer.backend.un("audioprocess",t)}),this.on("out",function(){e.loop&&e.wavesurfer.play(e.start)})},bindEvents:function(){var e=this;this.element.addEventListener("mouseenter",function(t){e.fireEvent("mouseenter",t),e.wavesurfer.fireEvent("region-mouseenter",e,t)}),this.element.addEventListener("mouseleave",function(t){e.fireEvent("mouseleave",t),e.wavesurfer.fireEvent("region-mouseleave",e,t)}),this.element.addEventListener("click",function(t){t.preventDefault(),e.fireEvent("click",t),e.wavesurfer.fireEvent("region-click",e,t)}),this.element.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault(),e.fireEvent("dblclick",t),e.wavesurfer.fireEvent("region-dblclick",e,t)}),(this.drag||this.resize)&&function(){var t,r,n,i=e.wavesurfer.getDuration(),s=function(s){s.stopPropagation(),n=e.wavesurfer.drawer.handleEvent(s)*i,"handle"==s.target.tagName.toLowerCase()?r=s.target.classList.contains("wavesurfer-handle-start")?"start":"end":t=!0},o=function(n){(t||r)&&(t=!1,r=!1,n.stopPropagation(),n.preventDefault(),e.fireEvent("update-end",n),e.wavesurfer.fireEvent("region-update-end",e,n))},a=function(s){if(t||r){var o=e.wavesurfer.drawer.handleEvent(s)*i,a=o-n;n=o,e.drag&&t&&e.onDrag(a),e.resize&&r&&e.onResize(a,r)}};e.element.addEventListener("mousedown",s),e.wrapper.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),e.on("remove",function(){document.body.removeEventListener("mouseup",o),e.wrapper.removeEventListener("mousemove",a)}),e.wavesurfer.on("destroy",function(){document.body.removeEventListener("mouseup",o)})}()},onDrag:function(e){this.update({start:this.start+e,end:this.end+e})},onResize:function(e,t){"start"==t?this.update({start:Math.min(this.start+e,this.end),end:Math.max(this.start+e,this.end)}):this.update({start:Math.min(this.end+e,this.start),end:Math.max(this.end+e,this.start)})}},e.util.extend(e.Region,e.Observer),e.initRegions=function(){this.regions||(this.regions=Object.create(e.Regions),this.regions.init(this))},e.addRegion=function(e){return this.initRegions(),this.regions.add(e)},e.clearRegions=function(){this.regions&&this.regions.clear()},e.enableDragSelection=function(e){this.initRegions(),this.regions.enableDragSelection(e)}})}])});