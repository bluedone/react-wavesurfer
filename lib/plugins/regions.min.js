!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports["plugins/regions"]=e(require("react")):(t.ReactWavesurfer=t.ReactWavesurfer||{},t.ReactWavesurfer["plugins/regions"]=e(t.React))}(this,function(t){return function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),h=i(2),u=r(h),c=(i(4),function(t){function e(t){return n(this,e),s(this,Object.getPrototypeOf(e).call(this,t))}return a(e,t),o(e,[{key:"componentDidMount",value:function(){this.props._isReady&&(console.log("init"),this.init()),this.props.wavesurfer.on("ready",this._init.bind(this))}},{key:"_init",value:function(){var t=this;this.props.regions.map(function(e){return console.log(t.props.wavesurfer),t.props.wavesurfer.addRegion(e)})}},{key:"render",value:function(){return u["default"].createElement("div",null)}}]),e}(h.Component));c.propTypes={isReady:h.PropTypes.bool,regions:h.PropTypes.array},c.defaultProps={regions:[]},e["default"]=c},function(t,e,i){var r,n;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};/*! wavesurfer.js 1.0.58 (Sun, 28 Feb 2016 19:39:50 GMT)
	* https://github.com/katspaugh/wavesurfer.js
	* @license CC-BY-3.0 */
!function(i,s){r=[],n=function(){return i.WaveSurfer=s()}.apply(e,r),!(void 0!==n&&(t.exports=n))}(void 0,function(){"use strict";var t={defaultParams:{height:128,waveColor:"#999",progressColor:"#555",cursorColor:"#333",cursorWidth:1,skipLength:2,minPxPerSec:20,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,fillParent:!0,scrollParent:!1,hideScrollbar:!1,normalize:!1,audioContext:null,container:null,dragSelection:!0,loopSelection:!0,audioRate:1,interact:!0,splitChannels:!1,mediaContainer:null,mediaControls:!1,renderer:"Canvas",backend:"WebAudio",mediaType:"audio",autoCenter:!0},init:function(e){if(this.params=t.util.extend({},this.defaultParams,e),this.container="string"==typeof e.container?document.querySelector(this.params.container):this.params.container,!this.container)throw new Error("Container element not found");if(null==this.params.mediaContainer?this.mediaContainer=this.container:"string"==typeof this.params.mediaContainer?this.mediaContainer=document.querySelector(this.params.mediaContainer):this.mediaContainer=this.params.mediaContainer,!this.mediaContainer)throw new Error("Media Container element not found");this.savedVolume=0,this.isMuted=!1,this.tmpEvents=[],this.createDrawer(),this.createBackend()},createDrawer:function(){var e=this;this.drawer=Object.create(t.Drawer[this.params.renderer]),this.drawer.init(this.container,this.params),this.drawer.on("redraw",function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())}),this.drawer.on("click",function(t,i){setTimeout(function(){e.seekTo(i)},0)}),this.drawer.on("scroll",function(t){e.fireEvent("scroll",t)})},createBackend:function(){var e=this;this.backend&&this.backend.destroy(),"AudioElement"==this.params.backend&&(this.params.backend="MediaElement"),"WebAudio"!=this.params.backend||t.WebAudio.supportsWebAudio()||(this.params.backend="MediaElement"),this.backend=Object.create(t[this.params.backend]),this.backend.init(this.params),this.backend.on("finish",function(){e.fireEvent("finish")}),this.backend.on("play",function(){e.fireEvent("play")}),this.backend.on("pause",function(){e.fireEvent("pause")}),this.backend.on("audioprocess",function(t){e.fireEvent("audioprocess",t)})},startAnimationLoop:function(){var t=this,e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,i=function r(){if(!t.backend.isPaused()){var i=t.backend.getPlayedPercents();t.drawer.progress(i),t.fireEvent("audioprocess",t.getCurrentTime()),e(r)}};i()},getDuration:function(){return this.backend.getDuration()},getCurrentTime:function(){return this.backend.getCurrentTime()},play:function(t,e){this.backend.play(t,e),this.startAnimationLoop()},pause:function(){this.backend.pause()},playPause:function(){this.backend.isPaused()?this.play():this.pause()},isPlaying:function(){return!this.backend.isPaused()},skipBackward:function(t){this.skip(-t||-this.params.skipLength)},skipForward:function(t){this.skip(t||this.params.skipLength)},skip:function(t){var e=this.getCurrentTime()||0,i=this.getDuration()||1;e=Math.max(0,Math.min(i,e+(t||0))),this.seekAndCenter(e/i)},seekAndCenter:function(t){this.seekTo(t),this.drawer.recenter(t)},seekTo:function(t){var e=this.backend.isPaused(),i=this.params.scrollParent;e&&(this.params.scrollParent=!1),this.backend.seekTo(t*this.getDuration()),this.drawer.progress(this.backend.getPlayedPercents()),e||(this.backend.pause(),this.backend.play()),this.params.scrollParent=i,this.fireEvent("seek",t)},stop:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)},setVolume:function(t){this.backend.setVolume(t)},setPlaybackRate:function(t){this.backend.setPlaybackRate(t)},toggleMute:function(){this.isMuted?(this.backend.setVolume(this.savedVolume),this.isMuted=!1):(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0)},toggleScroll:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()},toggleInteraction:function(){this.params.interact=!this.params.interact},drawBuffer:function(){var t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),e=this.drawer.getWidth(),i=t;this.params.fillParent&&(!this.params.scrollParent||e>t)&&(i=e);var r=this.backend.getPeaks(i);this.drawer.drawPeaks(r,i),this.fireEvent("redraw",r,i)},zoom:function(t){this.params.minPxPerSec=t,this.params.scrollParent=!0,this.drawBuffer(),this.seekAndCenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",t)},loadArrayBuffer:function(t){this.decodeArrayBuffer(t,function(t){this.loadDecodedBuffer(t)}.bind(this))},loadDecodedBuffer:function(t){this.backend.load(t),this.drawBuffer(),this.fireEvent("ready")},loadBlob:function(t){var e=this,i=new FileReader;i.addEventListener("progress",function(t){e.onProgress(t)}),i.addEventListener("load",function(t){e.loadArrayBuffer(t.target.result)}),i.addEventListener("error",function(){e.fireEvent("error","Error reading file")}),i.readAsArrayBuffer(t),this.empty()},load:function(t,e){switch(this.params.backend){case"WebAudio":return this.loadBuffer(t);case"MediaElement":return this.loadMediaElement(t,e)}},loadBuffer:function(t){return this.empty(),this.getArrayBuffer(t,this.loadArrayBuffer.bind(this))},loadMediaElement:function(t,e){this.empty(),this.backend.load(t,this.mediaContainer,e),this.tmpEvents.push(this.backend.once("canplay",function(){this.drawBuffer(),this.fireEvent("ready")}.bind(this)),this.backend.once("error",function(t){this.fireEvent("error",t)}.bind(this))),!e&&this.backend.supportsWebAudio()&&this.getArrayBuffer(t,function(t){this.decodeArrayBuffer(t,function(t){this.backend.buffer=t,this.drawBuffer()}.bind(this))}.bind(this))},decodeArrayBuffer:function(t,e){this.backend.decodeArrayBuffer(t,this.fireEvent.bind(this,"decoded"),this.fireEvent.bind(this,"error","Error decoding audiobuffer")),this.tmpEvents.push(this.once("decoded",e))},getArrayBuffer:function(e,i){var r=this,n=t.util.ajax({url:e,responseType:"arraybuffer"});return this.tmpEvents.push(n.on("progress",function(t){r.onProgress(t)}),n.on("success",i),n.on("error",function(t){r.fireEvent("error","XHR error: "+t.target.statusText)})),n},onProgress:function(t){if(t.lengthComputable)var e=t.loaded/t.total;else e=t.loaded/(t.loaded+1e6);this.fireEvent("loading",Math.round(100*e),t.target)},exportPCM:function(t,e,i){t=t||1024,e=e||1e4,i=i||!1;var r=this.backend.getPeaks(t,e),n=[].map.call(r,function(t){return Math.round(t*e)/e}),s=JSON.stringify(n);return i||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(s)),s},clearTmpEvents:function(){this.tmpEvents.forEach(function(t){t.un()})},empty:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)},destroy:function(){this.fireEvent("destroy"),this.clearTmpEvents(),this.unAll(),this.backend.destroy(),this.drawer.destroy()}};return t.create=function(e){var i=Object.create(t);return i.init(e),i},t.util={extend:function(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){Object.keys(e).forEach(function(i){t[i]=e[i]})}),t},getId:function(){return"wavesurfer_"+Math.random().toString(32).substring(2)},ajax:function(e){var i=Object.create(t.Observer),r=new XMLHttpRequest,n=!1;return r.open(e.method||"GET",e.url,!0),r.responseType=e.responseType||"json",r.addEventListener("progress",function(t){i.fireEvent("progress",t),t.lengthComputable&&t.loaded==t.total&&(n=!0)}),r.addEventListener("load",function(t){n||i.fireEvent("progress",t),i.fireEvent("load",t),200==r.status||206==r.status?i.fireEvent("success",r.response,t):i.fireEvent("error",t)}),r.addEventListener("error",function(t){i.fireEvent("error",t)}),r.send(),i.xhr=r,i}},t.Observer={on:function(t,e){this.handlers||(this.handlers={});var i=this.handlers[t];return i||(i=this.handlers[t]=[]),i.push(e),{name:t,callback:e,un:this.un.bind(this,t,e)}},un:function(t,e){if(this.handlers){var i=this.handlers[t];if(i)if(e)for(var r=i.length-1;r>=0;r--)i[r]==e&&i.splice(r,1);else i.length=0}},unAll:function(){this.handlers=null},once:function(t,e){var i=this,r=function n(){e.apply(this,arguments),setTimeout(function(){i.un(t,n)},0)};return this.on(t,r)},fireEvent:function(t){if(this.handlers){var e=this.handlers[t],i=Array.prototype.slice.call(arguments,1);e&&e.forEach(function(t){t.apply(null,i)})}}},t.util.extend(t,t.Observer),t.WebAudio={scriptBufferSize:256,PLAYING_STATE:0,PAUSED_STATE:1,FINISHED_STATE:2,supportsWebAudio:function(){return!(!window.AudioContext&&!window.webkitAudioContext)},getAudioContext:function(){return t.WebAudio.audioContext||(t.WebAudio.audioContext=new(window.AudioContext||window.webkitAudioContext)),t.WebAudio.audioContext},getOfflineAudioContext:function(e){return t.WebAudio.offlineAudioContext||(t.WebAudio.offlineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),t.WebAudio.offlineAudioContext},init:function(e){this.params=e,this.ac=e.audioContext||this.getAudioContext(),this.lastPlay=this.ac.currentTime,this.startPosition=0,this.scheduledPause=null,this.states=[Object.create(t.WebAudio.state.playing),Object.create(t.WebAudio.state.paused),Object.create(t.WebAudio.state.finished)],this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(this.PAUSED_STATE),this.setPlaybackRate(this.params.audioRate)},disconnectFilters:function(){this.filters&&(this.filters.forEach(function(t){t&&t.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))},setState:function(t){this.state!==this.states[t]&&(this.state=this.states[t],this.state.init.call(this))},setFilter:function(){this.setFilters([].slice.call(arguments))},setFilters:function(t){this.disconnectFilters(),t&&t.length&&(this.filters=t,this.analyser.disconnect(),t.reduce(function(t,e){return t.connect(e),e},this.analyser).connect(this.gainNode))},createScriptNode:function(){this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(this.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(this.scriptBufferSize),this.scriptNode.connect(this.ac.destination)},addOnAudioProcess:function(){var t=this;this.scriptNode.onaudioprocess=function(){var e=t.getCurrentTime();e>=t.getDuration()?(t.setState(t.FINISHED_STATE),t.fireEvent("pause")):e>=t.scheduledPause?(t.setState(t.PAUSED_STATE),t.fireEvent("pause")):t.state===t.states[t.PLAYING_STATE]&&t.fireEvent("audioprocess",e)}},removeOnAudioProcess:function(){this.scriptNode.onaudioprocess=null},createAnalyserNode:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)},createVolumeNode:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)},setVolume:function(t){this.gainNode.gain.value=t},getVolume:function(){return this.gainNode.gain.value},decodeArrayBuffer:function(t,e,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(t,function(t){e(t)}.bind(this),i)},getPeaks:function(t){for(var e=this.buffer.length/t,i=~~(e/10)||1,r=this.buffer.numberOfChannels,n=[],s=[],a=0;r>a;a++)for(var o=n[a]=[],h=this.buffer.getChannelData(a),u=0;t>u;u++){for(var c=~~(u*e),d=~~(c+e),l=h[0],f=h[0],p=c;d>p;p+=i){var m=h[p];m>f&&(f=m),l>m&&(l=m)}o[2*u]=f,o[2*u+1]=l,(0==a||f>s[2*u])&&(s[2*u]=f),(0==a||l<s[2*u+1])&&(s[2*u+1]=l)}return this.params.splitChannels?n:s},getPlayedPercents:function(){return this.state.getPlayedPercents.call(this)},disconnectSource:function(){this.source&&this.source.disconnect()},destroy:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect()},load:function(t){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=t,this.createSource()},createSource:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)},isPaused:function(){return this.state!==this.states[this.PLAYING_STATE]},getDuration:function(){return this.buffer?this.buffer.duration:0},seekTo:function(t,e){return this.scheduledPause=null,null==t&&(t=this.getCurrentTime(),t>=this.getDuration()&&(t=0)),null==e&&(e=this.getDuration()),this.startPosition=t,this.lastPlay=this.ac.currentTime,this.state===this.states[this.FINISHED_STATE]&&this.setState(this.PAUSED_STATE),{start:t,end:e}},getPlayedTime:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate},play:function(t,e){this.createSource();var i=this.seekTo(t,e);t=i.start,e=i.end,this.scheduledPause=e,this.source.start(0,t,e-t),this.setState(this.PLAYING_STATE),this.fireEvent("play")},pause:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(this.PAUSED_STATE),this.fireEvent("pause")},getCurrentTime:function(){return this.state.getCurrentTime.call(this)},setPlaybackRate:function(t){t=t||1,this.isPaused()?this.playbackRate=t:(this.pause(),this.playbackRate=t,this.play())}},t.WebAudio.state={},t.WebAudio.state.playing={init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}},t.WebAudio.state.paused={init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition}},t.WebAudio.state.finished={init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}},t.util.extend(t.WebAudio,t.Observer),t.MediaElement=Object.create(t.WebAudio),t.util.extend(t.MediaElement,{init:function(t){this.params=t,this.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},this.mediaType=t.mediaType.toLowerCase(),this.elementPosition=t.elementPosition,this.setPlaybackRate(this.params.audioRate)},load:function(t,e,i){var r=this,n=document.createElement(this.mediaType);n.controls=this.params.mediaControls,n.autoplay=this.params.autoplay||!1,n.preload="auto",n.src=t,n.style.width="100%",n.addEventListener("error",function(){r.fireEvent("error","Error loading media element")}),n.addEventListener("canplay",function(){r.fireEvent("canplay")}),n.addEventListener("ended",function(){r.fireEvent("finish")}),n.addEventListener("timeupdate",function(){r.fireEvent("audioprocess",r.getCurrentTime())});var s=e.querySelector(this.mediaType);s&&e.removeChild(s),e.appendChild(n),this.media=n,this.peaks=i,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)},isPaused:function(){return!this.media||this.media.paused},getDuration:function(){var t=this.media.duration;return t>=1/0&&(t=this.media.seekable.end()),t},getCurrentTime:function(){return this.media&&this.media.currentTime},getPlayedPercents:function(){return this.getCurrentTime()/this.getDuration()||0},setPlaybackRate:function(t){this.playbackRate=t||1,this.media.playbackRate=this.playbackRate},seekTo:function(t){null!=t&&(this.media.currentTime=t),this.clearPlayEnd()},play:function(t,e){this.seekTo(t),this.media.play(),e&&this.setPlayEnd(e),this.fireEvent("play")},pause:function(){this.media&&this.media.pause(),this.clearPlayEnd(),this.fireEvent("pause")},setPlayEnd:function(t){var e=this;this.onPlayEnd=function(i){i>=t&&(e.pause(),e.seekTo(t))},this.on("audioprocess",this.onPlayEnd)},clearPlayEnd:function(){this.onPlayEnd&&(this.un("audioprocess",this.onPlayEnd),this.onPlayEnd=null)},getPeaks:function(e){return this.buffer?t.WebAudio.getPeaks.call(this,e):this.peaks||[]},getVolume:function(){return this.media.volume},setVolume:function(t){this.media.volume=t},destroy:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}),t.AudioElement=t.MediaElement,t.Drawer={init:function(t,e){this.container=t,this.params=e,this.width=0,this.height=e.height*this.params.pixelRatio,this.lastPos=0,this.createWrapper(),this.createElements()},createWrapper:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()},handleEvent:function(t){t.preventDefault();var e=this.wrapper.getBoundingClientRect();return(t.clientX-e.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0},setupWrapperEvents:function(){var t=this;this.wrapper.addEventListener("click",function(e){var i=t.wrapper.offsetHeight-t.wrapper.clientHeight;if(0!=i){var r=t.wrapper.getBoundingClientRect();if(e.clientY>=r.bottom-i)return}t.params.interact&&t.fireEvent("click",e,t.handleEvent(e))}),this.wrapper.addEventListener("scroll",function(e){t.fireEvent("scroll",e)})},drawPeaks:function(t,e){this.resetScroll(),this.setWidth(e),this.params.barWidth?this.drawBars(t):this.drawWave(t)},style:function(t,e){return Object.keys(e).forEach(function(i){t.style[i]!==e[i]&&(t.style[i]=e[i])}),t},resetScroll:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)},recenter:function(t){var e=this.wrapper.scrollWidth*t;this.recenterOnPosition(e,!0)},recenterOnPosition:function(t,e){var i=this.wrapper.scrollLeft,r=~~(this.wrapper.clientWidth/2),n=t-r,s=n-i,a=this.wrapper.scrollWidth-this.wrapper.clientWidth;if(0!=a){if(!e&&s>=-r&&r>s){var o=5;s=Math.max(-o,Math.min(o,s)),n=i+s}n=Math.max(0,Math.min(a,n)),n!=i&&(this.wrapper.scrollLeft=n)}},getWidth:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)},setWidth:function(t){t!=this.width&&(this.width=t,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize())},setHeight:function(t){t!=this.height&&(this.height=t,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize())},progress:function(t){var e=1/this.params.pixelRatio,i=Math.round(t*this.width)*e;if(i<this.lastPos||i-this.lastPos>=e){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var r=~~(this.wrapper.scrollWidth*t);this.recenterOnPosition(r)}this.updateProgress(t)}},destroy:function(){this.unAll(),this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=null)},createElements:function(){},updateSize:function(){},drawWave:function(t,e){},clearWave:function(){},updateProgress:function(t){}},t.util.extend(t.Drawer,t.Observer),t.Drawer.Canvas=Object.create(t.Drawer),t.util.extend(t.Drawer.Canvas,{createElements:function(){var t=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:0,top:0,bottom:0}));if(this.waveCc=t.getContext("2d"),this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})),this.params.waveColor!=this.params.progressColor){var e=this.progressWave.appendChild(document.createElement("canvas"));this.progressCc=e.getContext("2d")}},updateSize:function(){var t=Math.round(this.width/this.params.pixelRatio);this.waveCc.canvas.width=this.width,this.waveCc.canvas.height=this.height,this.style(this.waveCc.canvas,{width:t+"px"}),this.style(this.progressWave,{display:"block"}),this.progressCc&&(this.progressCc.canvas.width=this.width,this.progressCc.canvas.height=this.height,this.style(this.progressCc.canvas,{width:t+"px"})),this.clearWave()},clearWave:function(){this.waveCc.clearRect(0,0,this.width,this.height),this.progressCc&&this.progressCc.clearRect(0,0,this.width,this.height)},drawBars:function(t,e){if(t[0]instanceof Array){var i=t;if(this.params.splitChannels)return this.setHeight(i.length*this.params.height*this.params.pixelRatio),void i.forEach(this.drawBars,this);t=i[0]}var r=[].some.call(t,function(t){return 0>t});r&&(t=[].filter.call(t,function(t,e){return e%2==0}));var n=.5/this.params.pixelRatio,s=this.width,a=this.params.height*this.params.pixelRatio,o=a*e||0,h=a/2,u=t.length,c=this.params.barWidth*this.params.pixelRatio,d=Math.max(this.params.pixelRatio,~~(c/2)),l=c+d,f=1;this.params.normalize&&(f=Math.max.apply(Math,t));var p=u/s;this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(e){if(e)for(var i=0;s>i;i+=l){var r=Math.round(t[Math.floor(i*p)]/f*h);e.fillRect(i+n,h-r+o,c+n,2*r)}},this)},drawWave:function(t,e){if(t[0]instanceof Array){var i=t;if(this.params.splitChannels)return this.setHeight(i.length*this.params.height*this.params.pixelRatio),void i.forEach(this.drawWave,this);t=i[0]}var r=[].some.call(t,function(t){return 0>t});if(!r){for(var n=[],s=0,a=t.length;a>s;s++)n[2*s]=t[s],n[2*s+1]=-t[s];t=n}var o=.5/this.params.pixelRatio,h=this.params.height*this.params.pixelRatio,u=h*e||0,c=h/2,d=~~(t.length/2),l=1;this.params.fillParent&&this.width!=d&&(l=this.width/d);var f=1;if(this.params.normalize){var p=Math.max.apply(Math,t),m=Math.min.apply(Math,t);f=-m>p?-m:p}this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(e){if(e){e.beginPath(),e.moveTo(o,c+u);for(var i=0;d>i;i++){var r=Math.round(t[2*i]/f*c);e.lineTo(i*l+o,c-r+u)}for(var i=d-1;i>=0;i--){var r=Math.round(t[2*i+1]/f*c);e.lineTo(i*l+o,c-r+u)}e.closePath(),e.fill(),e.fillRect(0,c+u-o,this.width,o)}},this)},updateProgress:function(t){var e=Math.round(this.width*t)/this.params.pixelRatio;this.style(this.progressWave,{width:e+"px"})}}),function(){var e=function i(){var i=document.querySelectorAll("wavesurfer");Array.prototype.forEach.call(i,function(e){var i=t.util.extend({container:e,backend:"MediaElement",mediaControls:!0},e.dataset);e.style.display="block";var r=t.create(i);if(e.dataset.peaks)var n=JSON.parse(e.dataset.peaks);r.load(e.dataset.url,n)})};"complete"===document.readyState?e():window.addEventListener("load",e)}(),t})},function(e,i){e.exports=t},,function(t,e,i){var r,n;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(s,a){r=[i(1)],n=function(t){return a(t)}.apply(e,r),!(void 0!==n&&(t.exports=n))}(void 0,function(t){"use strict";t.Regions={init:function(t){this.wavesurfer=t,this.wrapper=this.wavesurfer.drawer.wrapper,this.list={}},add:function(e){var i=Object.create(t.Region);return i.init(e,this.wavesurfer),this.list[i.id]=i,i.on("remove",function(){delete this.list[i.id]}.bind(this)),i},clear:function(){Object.keys(this.list).forEach(function(t){this.list[t].remove()},this)},enableDragSelection:function(t){function e(t){n=!0,"undefined"!=typeof t.targetTouches&&1===t.targetTouches.length&&(t.clientX=t.targetTouches[0].clientX),s=o.wavesurfer.drawer.handleEvent(t),a=null}function i(t){n=!1,a&&(a.fireEvent("update-end",t),o.wavesurfer.fireEvent("region-update-end",a,t)),a=null}function r(e){if(n){a||(a=o.add(t||{}));var i=o.wavesurfer.getDuration();"undefined"!=typeof e.targetTouches&&1===e.targetTouches.length&&(e.clientX=e.targetTouches[0].clientX);var r=o.wavesurfer.drawer.handleEvent(e);a.update({start:Math.min(r*i,s*i),end:Math.max(r*i,s*i)})}}var n,s,a,o=this;this.wrapper.addEventListener("mousedown",e),this.wrapper.addEventListener("touchstart",e),this.wrapper.addEventListener("mouseup",i),this.wrapper.addEventListener("touchend",i),this.wrapper.addEventListener("mousemove",r),this.wrapper.addEventListener("touchmove",r)}},t.Region={style:t.Drawer.style,init:function(e,i){this.wavesurfer=i,this.wrapper=i.drawer.wrapper,this.id=null==e.id?t.util.getId():e.id,this.start=Number(e.start)||0,this.end=null==e.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(e.end),this.resize=void 0===e.resize?!0:Boolean(e.resize),this.drag=void 0===e.drag?!0:Boolean(e.drag),this.loop=Boolean(e.loop),this.color=e.color||"rgba(0, 0, 0, 0.1)",this.data=e.data||{},this.attributes=e.attributes||{},this.maxLength=e.maxLength,this.minLength=e.minLength,this.bindInOut(),this.render(),this.wavesurfer.on("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-created",this)},update:function(t){null!=t.start&&(this.start=Number(t.start)),null!=t.end&&(this.end=Number(t.end)),null!=t.loop&&(this.loop=Boolean(t.loop)),null!=t.color&&(this.color=t.color),null!=t.data&&(this.data=t.data),null!=t.resize&&(this.resize=Boolean(t.resize)),null!=t.drag&&(this.drag=Boolean(t.drag)),null!=t.maxLength&&(this.maxLength=Number(t.maxLength)),null!=t.minLength&&(this.minLength=Number(t.minLength)),null!=t.attributes&&(this.attributes=t.attributes),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this)},remove:function(t){this.element&&(this.wrapper.removeChild(this.element),this.element=null,this.fireEvent("remove"),this.wavesurfer.un("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-removed",this))},play:function(){this.wavesurfer.play(this.start,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)},playLoop:function(){this.play(),this.once("out",this.playLoop.bind(this))},render:function(){var t=document.createElement("region");t.className="wavesurfer-region",t.title=this.formatTime(this.start,this.end),t.setAttribute("data-id",this.id);for(var e in this.attributes)t.setAttribute("data-region-"+e,this.attributes[e]);this.wrapper.scrollWidth;if(this.style(t,{position:"absolute",zIndex:2,height:"100%",top:"0px"}),this.resize){var i=t.appendChild(document.createElement("handle")),r=t.appendChild(document.createElement("handle"));i.className="wavesurfer-handle wavesurfer-handle-start",r.className="wavesurfer-handle wavesurfer-handle-end";var n={cursor:"col-resize",position:"absolute",left:"0px",top:"0px",width:"1%",maxWidth:"4px",height:"100%"};this.style(i,n),this.style(r,n),this.style(r,{left:"100%"})}this.element=this.wrapper.appendChild(t),this.updateRender(),this.bindEvents(t)},formatTime:function(t,e){return(t==e?[t]:[t,e]).map(function(t){return[Math.floor(t%3600/60),("00"+Math.floor(t%60)).slice(-2)].join(":")}).join("-")},updateRender:function(t){var e,i=this.wavesurfer.getDuration();if(e=t?Math.round(this.wavesurfer.getDuration()*t):this.wrapper.scrollWidth,this.start<0&&(this.start=0,this.end=this.end-this.start),this.end>i&&(this.end=i,this.start=i-(this.end-this.start)),null!=this.minLength&&(this.end=Math.max(this.start+this.minLength,this.end)),null!=this.maxLength&&(this.end=Math.min(this.start+this.maxLength,this.end)),null!=this.element){this.style(this.element,{left:~~(this.start/i*e)+"px",width:~~((this.end-this.start)/i*e)+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"});for(var r in this.attributes)this.element.setAttribute("data-region-"+r,this.attributes[r]);this.element.title=this.formatTime(this.start,this.end)}},bindInOut:function(){var t=this;t.firedIn=!1,t.firedOut=!1;var e=function(e){!t.firedIn&&t.start<=e&&t.end>e&&(t.firedIn=!0,t.firedOut=!1,t.fireEvent("in"),t.wavesurfer.fireEvent("region-in",t)),!t.firedOut&&t.firedIn&&(t.start>=Math.round(100*e)/100||t.end<=Math.round(100*e)/100)&&(t.firedOut=!0,t.firedIn=!1,t.fireEvent("out"),t.wavesurfer.fireEvent("region-out",t))};this.wavesurfer.backend.on("audioprocess",e),this.on("remove",function(){t.wavesurfer.backend.un("audioprocess",e)}),this.on("out",function(){t.loop&&t.wavesurfer.play(t.start)})},bindEvents:function(){var t=this;this.element.addEventListener("mouseenter",function(e){t.fireEvent("mouseenter",e),t.wavesurfer.fireEvent("region-mouseenter",t,e)}),this.element.addEventListener("mouseleave",function(e){t.fireEvent("mouseleave",e),t.wavesurfer.fireEvent("region-mouseleave",t,e)}),this.element.addEventListener("click",function(e){e.preventDefault(),t.fireEvent("click",e),t.wavesurfer.fireEvent("region-click",t,e)}),this.element.addEventListener("dblclick",function(e){e.stopPropagation(),e.preventDefault(),t.fireEvent("dblclick",e),t.wavesurfer.fireEvent("region-dblclick",t,e)}),(this.drag||this.resize)&&function(){var e,i,r,n=t.wavesurfer.getDuration(),s=function(s){s.stopPropagation(),r=t.wavesurfer.drawer.handleEvent(s)*n,"handle"==s.target.tagName.toLowerCase()?i=s.target.classList.contains("wavesurfer-handle-start")?"start":"end":e=!0},a=function(r){(e||i)&&(e=!1,i=!1,r.stopPropagation(),r.preventDefault(),t.fireEvent("update-end",r),t.wavesurfer.fireEvent("region-update-end",t,r))},o=function(s){if(e||i){var a=t.wavesurfer.drawer.handleEvent(s)*n,o=a-r;r=a,t.drag&&e&&t.onDrag(o),t.resize&&i&&t.onResize(o,i)}};t.element.addEventListener("mousedown",s),t.wrapper.addEventListener("mousemove",o),document.body.addEventListener("mouseup",a),t.on("remove",function(){document.body.removeEventListener("mouseup",a),t.wrapper.removeEventListener("mousemove",o)}),t.wavesurfer.on("destroy",function(){document.body.removeEventListener("mouseup",a)})}()},onDrag:function(t){this.update({start:this.start+t,end:this.end+t})},onResize:function(t,e){"start"==e?this.update({start:Math.min(this.start+t,this.end),end:Math.max(this.start+t,this.end)}):this.update({start:Math.min(this.end+t,this.start),end:Math.max(this.end+t,this.start)})}},t.util.extend(t.Region,t.Observer),t.initRegions=function(){this.regions||(this.regions=Object.create(t.Regions),this.regions.init(this))},t.addRegion=function(t){return this.initRegions(),this.regions.add(t)},t.clearRegions=function(){this.regions&&this.regions.clear()},t.enableDragSelection=function(t){this.initRegions(),this.regions.enableDragSelection(t)}})}])});